# Настройка и запуск файлового сервера (Port 5005)

Этот сервер необходим для того, чтобы Rutube мог "забирать" (скачивать) видеофайлы с вашего компьютера.

## Где находится скрипт
Скрипт сервера находится в файле: `rutube/server_simple.py`.

## Как настраивается порт
Порт и другие настройки берутся из файла `rutube/config.py`.

*   **`SERVER_PORT`**: Порт, на котором запускается сервер (по умолчанию **5005**).
*   **`PUBLIC_IP`**: Ваше доменное имя (например, `crosspostly.hopto.org`), которое используется для формирования ссылок на видео.
*   **`UPLOADS_DIR`**: Папка, из которой сервер раздает файлы (по умолчанию `rutube/uploads`).

## Как запустить сервер

### Ручной запуск (для тестов)
Находясь в корне проекта:
```bash
python3 rutube/server_simple.py
```

### Запуск в фоне (как сейчас)
Сервер обычно запускается одной из команд в составе общей автоматизации или вручную через `nohup`/`&`.
Чтобы проверить, запущен ли он сейчас:
```bash
ps aux | grep server_simple.py
```

Чтобы проверить, слушается ли порт:
```bash
ss -tuln | grep 5005
```

## Как это работает
1. Скрипт `sync_production.py` скачивает видео с YouTube в папку `uploads`.
2. Он формирует ссылку вида `https://ВАШ_ДОМЕН/rutube-webhook/static/VIDEO_ID.mp4`.
3. Эта ссылка отправляется в API Rutube.
4. Rutube делает запрос по этой ссылке.
5. `server_simple.py` принимает запрос, находит файл в папке `uploads` и отдает его Rutube.
