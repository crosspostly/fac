# Инструкция по отладке Playwright (Rutube)

Поскольку Rutube активно защищается от автоматизации (Headless Detection) и использует тяжелые SPA-фреймворки, запуск скриптов в облачном/headless окружении может не работать (пустая страница, тайм-ауты).

Для успешной отладки и запуска рекомендуется запускать скрипты **локально** в обычном режиме (не headless).

## 1. Подготовка

Убедитесь, что у вас установлен Playwright:
```bash
pip install playwright
playwright install chromium
```

Убедитесь, что файл `rutube/rutube_cookies.json` содержит **свежие** куки из вашего браузера.

## 2. Поиск селекторов (`find_selectors.py`)

Этот скрипт пытается найти видео в списке и определить правильные селекторы.

**Запуск:**
```bash
python3 rutube/find_selectors.py
```

**Если скрипт падает или не находит ссылки:**
1. Откройте `rutube/find_selectors.py`.
2. Найдите строку `browser = p.chromium.launch(headless=True)`.
3. Замените `headless=True` на `headless=False`. Это запустит реальное окно браузера.
4. Вы сможете увидеть, что происходит на экране (капча, долгая загрузка, ошибки).

## 3. Загрузка обложки (`set_thumbnail_playwright.py`)

Этот скрипт пытается загрузить обложку для последнего видео.

**Запуск:**
```bash
python3 rutube/set_thumbnail_playwright.py
```

**Рекомендации:**
*   Если видите ошибку навигации, увеличьте таймауты в коде (`page.goto(..., timeout=60000)`).
*   Если видите перенаправление на логин (`/login`), значит куки не подходят для `studio.rutube.ru`. Нужно обновить их.

## 4. Обновление куки

1. Зайдите на `https://studio.rutube.ru/` в своем браузере.
2. Используйте расширение (например, "EditThisCookie" или "Cookie-Editor") для экспорта куки в формате JSON.
3. Сохраните их в `rutube/rutube_cookies.json`.
